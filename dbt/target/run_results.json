{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-10-06T17:51:29.563350Z", "invocation_id": "4ff1157d-53cf-4a8b-8b98-e22f87a280f2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:06.273909Z", "completed_at": "2024-10-06T17:51:06.983621Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:07.315887Z", "completed_at": "2024-10-06T17:51:14.903169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.613437175750732, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "31cecb7d-e76d-419a-97e6-5a552b94eb46", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.raw_orders", "compiled": true, "compiled_code": "-- models/staging/raw_orders.sql\nselect\n    order_id,\n    customer_id,\n    order_status,\n    order_purchase_timestamp,\n    order_approved_at,\n    order_delivered_carrier_date,\n    order_delivered_customer_date,\n    order_estimated_delivery_date\nfrom `my-etl-project-434409`.`etl_dataset`.`orders`", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`raw_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:05.980998Z", "completed_at": "2024-10-06T17:51:06.603213Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:06.831685Z", "completed_at": "2024-10-06T17:51:14.931962Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.591275453567505, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "36a5adea-6235-40c8-b1e1-ac61a9f48f19", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.stg_customers", "compiled": true, "compiled_code": "-- models/staging/stg_customers.sql\n\nselect\n    customer_id,\n    customer_unique_id,\n    customer_city,\n    customer_state\nfrom `my-etl-project-434409`.`etl_dataset`.`customers`  -- Reference to the raw 'customers' table in PostgreSQL", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`stg_customers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:05.858677Z", "completed_at": "2024-10-06T17:51:06.785658Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:07.047747Z", "completed_at": "2024-10-06T17:51:14.960483Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 9.879979610443115, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "81b41d41-f45d-444a-bc12-81281b6d231a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.stg_order_items", "compiled": true, "compiled_code": "-- models/staging/stg_order_items.sql\n\nselect\n    order_id,\n    product_id,\n    price,\n    freight_value,\n    order_item_id\nfrom `my-etl-project-434409`.`etl_dataset`.`order_items`  -- Pulls data from the 'order_items' table in PostgreSQL", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`stg_order_items`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:05.565785Z", "completed_at": "2024-10-06T17:51:06.515808Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:06.534268Z", "completed_at": "2024-10-06T17:51:14.911958Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 9.94898796081543, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "ee5791ff-8dc1-4d9d-bf9f-bf388277dcf3", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.stg_products", "compiled": true, "compiled_code": "-- models/staging/stg_products.sql\n\nwith products as (\n    -- Select the raw product data from the source table in PostgreSQL\n    select\n        product_id,\n        product_category_name,\n        product_name_length,\n        product_description_length,\n        product_photos_qty,\n        product_weight_g,\n        product_length_cm,\n        product_height_cm,\n        product_width_cm\n    from `my-etl-project-434409`.`etl_dataset`.`products`  -- Referencing the raw 'products' table\n)\n\n, clean_products as (\n    -- Clean the raw product data (e.g., handling nulls, renaming columns)\n    select\n        product_id,\n        product_category_name,\n        coalesce(product_name_length, 0) as product_name_length,  -- Replace nulls with 0\n        coalesce(product_description_length, 0) as product_description_length,  -- Replace nulls with 0\n        coalesce(product_photos_qty, 0) as product_photos_qty,  -- Replace nulls with 0\n        coalesce(product_weight_g, 0) as product_weight_g,  -- Replace nulls with 0\n        coalesce(product_length_cm, 0) as product_length_cm,  -- Replace nulls with 0\n        coalesce(product_height_cm, 0) as product_height_cm,  -- Replace nulls with 0\n        coalesce(product_width_cm, 0) as product_width_cm  -- Replace nulls with 0\n    from products\n)\n\nselect * from clean_products", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`stg_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:15.582088Z", "completed_at": "2024-10-06T17:51:15.769083Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:15.834380Z", "completed_at": "2024-10-06T17:51:19.230512Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.7597522735595703, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "f48b0aea-802f-48ef-8ba6-0a65e7506178", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.int_sales_by_category", "compiled": true, "compiled_code": "-- models/intermediate/int_sales_by_category.sql\n\nwith category_sales as (\n    select\n        p.product_category_name,\n        sum(oi.price) as total_sales\n    from `my-etl-project-434409`.`etl_dataset`.`stg_products` p  -- Referencing the staging model 'stg_products'\n    join `my-etl-project-434409`.`etl_dataset`.`stg_order_items` oi  -- Referencing the staging model 'stg_orders_items'\n    on p.product_id = oi.product_id  -- Joining on product_id\n    group by p.product_category_name\n)\n\nselect * from category_sales", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:15.644541Z", "completed_at": "2024-10-06T17:51:15.827475Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:15.921728Z", "completed_at": "2024-10-06T17:51:19.414176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.229892730712891, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "b646732a-fe02-4370-a02a-94771565375e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.stg_orders", "compiled": true, "compiled_code": "-- models/staging/stg_orders.sql\nwith orders as (\n    select\n        order_id,\n        customer_id,\n        order_status,\n        order_purchase_timestamp,\n        order_approved_at,\n        order_delivered_carrier_date,\n        order_delivered_customer_date,\n        order_estimated_delivery_date\n    from `my-etl-project-434409`.`etl_dataset`.`raw_orders`  -- This references the raw_orders model\n)\n\nselect * from orders", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`stg_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:19.483003Z", "completed_at": "2024-10-06T17:51:19.863869Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:19.998775Z", "completed_at": "2024-10-06T17:51:24.537465Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.112587213516235, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "403ebd99-bc85-45de-87e6-13c12bd55c60", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.fct_sales_by_category", "compiled": true, "compiled_code": "-- models/final/fct_sales_by_category.sql\n\nselect\n    product_category_name,\n    total_sales\nfrom `my-etl-project-434409`.`etl_dataset`.`int_sales_by_category`", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`fct_sales_by_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:19.872667Z", "completed_at": "2024-10-06T17:51:20.207388Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:20.256494Z", "completed_at": "2024-10-06T17:51:24.687481Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.839704513549805, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "08a5321a-41b7-402d-a444-dfc881de67be", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.int_orders_by_state", "compiled": true, "compiled_code": "-- models/intermediate/int_orders_by_state.sql\n\nwith orders_by_state as (\n    -- Join orders and customers (or another relevant table) to get state information\n    select\n        c.customer_state,\n        count(o.order_id) as total_orders\n    from `my-etl-project-434409`.`etl_dataset`.`stg_orders` o  -- Referencing the 'stg_orders' staging model for orders\n    join `my-etl-project-434409`.`etl_dataset`.`stg_customers` c  -- Referencing the 'stg_customers' staging model for customer details\n    on o.customer_id = c.customer_id  -- Joining orders and customers by customer_id\n    group by c.customer_state\n)\n\nselect * from orders_by_state", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:20.101598Z", "completed_at": "2024-10-06T17:51:20.290551Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:20.303766Z", "completed_at": "2024-10-06T17:51:24.812598Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.021104574203491, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "f591322e-eec7-4efe-8acb-bfb67506ec5d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.int_avg_delivery_time", "compiled": true, "compiled_code": "with delivery_times as (\n    -- Calculate the delivery time for each order\n    select\n        order_id,\n        customer_id,\n        order_purchase_timestamp,\n        order_delivered_customer_date,\n        date_diff(order_delivered_customer_date, order_purchase_timestamp, DAY) as delivery_days\n    from `my-etl-project-434409`.`etl_dataset`.`stg_orders`  -- Referencing the 'stg_orders' staging model\n    where order_delivered_customer_date is not null  -- Only consider orders that have been delivered\n)\n\n, avg_delivery_time as (\n    -- Calculate the average delivery time for all orders\n    select\n        customer_id,\n        avg(delivery_days) as avg_delivery_days\n    from delivery_times\n    group by customer_id\n)\n\nselect * from avg_delivery_time", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:24.840232Z", "completed_at": "2024-10-06T17:51:24.997996Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:25.009944Z", "completed_at": "2024-10-06T17:51:28.492234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6970291137695312, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "6e0de717-7cdf-4dd9-93c8-ccde006cf795", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.fct_orders_by_state", "compiled": true, "compiled_code": "-- models/final/fct_orders_by_state.sql\n\nwith orders_by_state as (\n    -- Reference the intermediate model to get the total orders per state\n    select\n        customer_state,\n        total_orders\n    from `my-etl-project-434409`.`etl_dataset`.`int_orders_by_state`  -- Referencing the intermediate model 'int_orders_by_state'\n)\n\nselect\n    customer_state,\n    total_orders\nfrom orders_by_state\norder by total_orders desc;  -- Order the results by the total number of orders, highest to lowest", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`fct_orders_by_state`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-06T17:51:24.970003Z", "completed_at": "2024-10-06T17:51:25.139069Z"}, {"name": "execute", "started_at": "2024-10-06T17:51:25.171609Z", "completed_at": "2024-10-06T17:51:29.039874Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.121800661087036, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "my-etl-project-434409", "job_id": "a0bde57e-dca9-4551-a8e9-da72b8812cf6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.ecommerce_project.fct_avg_delivery_time", "compiled": true, "compiled_code": "with avg_delivery_time as (\n    -- Reference the intermediate model to get the average delivery time per customer\n    select\n        customer_id,\n        avg_delivery_days\n    from `my-etl-project-434409`.`etl_dataset`.`int_avg_delivery_time`  -- Referencing the intermediate model 'int_avg_delivery_time'\n),\n\noverall_avg_delivery_time as (\n    -- Calculate the overall average delivery time across all customers\n    select\n        avg(avg_delivery_days) as overall_avg_delivery_days\n    from avg_delivery_time\n)\n\nselect\n    overall_avg_delivery_days\nfrom overall_avg_delivery_time", "relation_name": "`my-etl-project-434409`.`etl_dataset`.`fct_avg_delivery_time`"}], "elapsed_time": 29.249832153320312, "args": {"send_anonymous_usage_stats": true, "favor_state": false, "version_check": true, "require_resource_names_without_spaces": false, "printer_width": 80, "profiles_dir": "/usr/app/dbt", "project_dir": "/usr/app/dbt", "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "use_colors": true, "indirect_selection": "eager", "strict_mode": false, "log_level": "info", "log_file_max_bytes": 10485760, "macro_debugging": false, "vars": {}, "log_level_file": "debug", "log_format_file": "debug", "empty": false, "partial_parse": true, "exclude": [], "write_json": true, "print": true, "populate_cache": true, "which": "run", "select": [], "source_freshness_run_project_hooks": false, "show_resource_report": false, "defer": false, "invocation_command": "dbt run", "introspect": true, "partial_parse_file_diff": true, "use_colors_file": true, "log_path": "/usr/app/dbt/logs", "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "enable_legacy_logger": false}}